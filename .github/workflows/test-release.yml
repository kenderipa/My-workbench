name: Test tag
concurrency:
  group: build-${{ github.ref }}
  cancel-in-progress: true

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3

    - name: build
      if: always()
      run: |
        echo "latest_tag=$(wget -q https://api.github.com/repos/ivan-hc/AM-Application-Manager/releases/latest -O - | grep tag_name | cut -d '"' -f 4)" >> "$GITHUB_ENV"
       
    - name: AppMan Release
      uses: ncipollo/release-action@v1.12.0
      with:
          name: AppMan ${{ env.GITHUB_ENV }}
          tag: ${{ env.GITHUB_ENV }}
          prerelease: false
          token: ${{ secrets.GITHUB_TOKEN }}
          allowUpdates: true
          removeArtifacts: true
          artifactErrorsFailBuild: true
          generateReleaseNotes: true
